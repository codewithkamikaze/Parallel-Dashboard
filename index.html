<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Parallel Dashboard</title>
    <style>
      body {
        font-family: system-ui, sans-serif;
        margin: 0;
        padding: 24px;
        background: #0b1020;
        color: #e9eefc;
      }
      .app {
        max-width: 900px;
        margin: 0 auto;
      }
      .card {
        background: rgba(255, 255, 255, 0.06);
        border: 1px solid rgba(255, 255, 255, 0.12);
        border-radius: 16px;
        padding: 16px;
      }
      .row {
        display: flex;
        gap: 12px;
        flex-wrap: wrap;
        align-items: center;
        margin-bottom: 12px;
      }
      button {
        border: 0;
        border-radius: 12px;
        padding: 10px 16px;
        cursor: pointer;
        background: #4f7cff;
        color: #fff;
        font-weight: 700;
        display: flex;
        align-items: center;
        gap: 8px;
        transition: background 0.2s;
      }
      button:disabled {
        background: #728fff;
        cursor: not-allowed;
      }
      .spinner {
        border: 3px solid rgba(255, 255, 255, 0.2);
        border-top: 3px solid #fff;
        border-radius: 50%;
        width: 16px;
        height: 16px;
        animation: spin 0.6s linear infinite;
      }
      @keyframes spin {
        0% {
          transform: rotate(0deg);
        }
        100% {
          transform: rotate(360deg);
        }
      }
      .stats {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: 12px;
        margin-top: 12px;
      }
      .stat {
        padding: 14px;
        border-radius: 14px;
        background: rgba(0, 0, 0, 0.18);
        border: 1px solid rgba(255, 255, 255, 0.08);
        transition: transform 0.2s;
      }
      .stat:hover {
        transform: translateY(-4px);
      }
      .muted {
        opacity: 0.75;
      }
      .pill {
        display: inline-block;
        padding: 4px 12px;
        border-radius: 999px;
        background: rgba(255, 255, 255, 0.12);
        border: 1px solid rgba(255, 255, 255, 0.12);
        font-size: 12px;
        min-width: 60px;
        text-align: center;
      }
    </style>
  </head>
  <body>
    <div class="app">
      <div class="card">
        <h2 style="margin: 0 0 8px">Parallel Fetch Dashboard</h2>
        <p class="muted" style="margin: 0 0 14px">
          Load users and posts at the same time and show quick stats.
        </p>

        <div class="row">
          <button id="btn">
            <span id="btnText">Load Dashboard</span>
            <div id="spinner" class="spinner" style="display: none"></div>
          </button>
          <span class="pill" id="status">Idle</span>
        </div>

        <div class="stats" id="stats"></div>
        <div class="muted" id="err" style="margin-top: 12px"></div>
      </div>
    </div>

    <script>
      const btn = document.getElementById("btn");
      const btnText = document.getElementById("btnText");
      const spinner = document.getElementById("spinner");
      const statusEl = document.getElementById("status");
      const stats = document.getElementById("stats");
      const err = document.getElementById("err");

      function setStatus(text) {
        statusEl.textContent = text;
      }

      function card(title, value, note = "") {
        return `
        <div class="stat">
          <div class="muted">${title}</div>
          <div style="font-size:28px;font-weight:800;margin-top:6px;">${value}</div>
          <div class="muted" style="margin-top:6px;">${note}</div>
        </div>
      `;
      }

      async function loadDashboard() {
        btn.disabled = true;
        spinner.style.display = "inline-block";
        btnText.textContent = "Loading";
        err.textContent = "";
        stats.innerHTML = "";
        setStatus("Loading...");

        try {
          const [usersRes, postsRes] = await Promise.all([
            fetch("https://jsonplaceholder.typicode.com/users"),
            fetch("https://jsonplaceholder.typicode.com/posts"),
          ]);

          if (!usersRes.ok) throw new Error("Users API request failed");
          if (!postsRes.ok) throw new Error("Posts API request failed");

          const [users, posts] = await Promise.all([
            usersRes.json(),
            postsRes.json(),
          ]);

          const postsPerUser = Math.round(posts.length / users.length);

          stats.innerHTML = [
            card("Users", users.length.toLocaleString(), "Fetched from API"),
            card("Posts", posts.length.toLocaleString(), "Fetched from API"),
            card(
              "Avg posts/user",
              postsPerUser.toLocaleString(),
              "Computed locally",
            ),
          ].join("");

          setStatus("✅ Ready");
        } catch (e) {
          setStatus("❌ Error");
          err.textContent = `Failed: ${e.message}`;
        } finally {
          btn.disabled = false;
          spinner.style.display = "none";
          btnText.textContent = "Load Dashboard";
        }
      }

      btn.addEventListener("click", loadDashboard);
    </script>
  </body>
</html>
